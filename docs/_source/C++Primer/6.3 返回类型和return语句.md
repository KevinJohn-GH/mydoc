# 6.3 返回类型和return语句

return语句终止当前正在执行的函数并将控制权返回到调用该函数的地方。



## 6.3.1 无返回值函数

没有返回值的return语句只能用在返回值是void的函数中。void类型的函数最后会隐式地执行return。



## 6.3.2 有返回值函数

> 在含有return语句的循环后面应该也有一条return语句，如果没有的话该程序就是错误的。很多编译器都无法发现此类错误。

#### 值是如何被返回的

返回一个值的方式和初始化一个变量或形参的方式完全一样：返回的值用于初始化调用点的一个临时量，该临时量就是函数调用的结果。（临时量的类型就是函数的返回类型）。

函数的每一个结束点都应该有return。

#### 不要返回局部对象的引用或指针

函数完成后，它所占用的存储空间也随之被释放调。因此，函数终止意味着局部变量的引用将不再有效的内存领域。

函数内的字面值也会转换成局部临时对象。

####返回类类型的函数和调用运算符 

调用运算符的优先级与点运算符和箭头运算符相同，并且也符合左结合律。因此，如果函数返回指针、引用或类的对象，我们就能使用函数调用的结果访问结果对象的成员。

#### 引用返回左值

#### 列表初始化返回

C++新标准规定，函数可以返回花括号包围的列表。

```c++
vector <string> process(){
return{"hello", "world"}
}
```

#### 主函数main的返回值

例外：允许main函数没有return语句直接结束。如果main函数的末尾没有return语句，编译器将隐式地插入一条返回0的return语句。

main函数返回0表示成功，返回其它表示失败。cstdlib头文件定义了两个预处理变量，可以使用这两个变量分别代表成功和失败：

```c++
return EXIT_FALLURE;	//定义在cstdlib头文件中
return EXIT_SUCCESS;
```



## 6.3.3 返回数组指针

因为数组不能被拷贝，所以函数不能返回数组。不过，函数可以返回数组的指针或引用。

####声明一个返回数组指针的函数

```C++
Type (*function(paraater_list))[dimension]
```

`(*function(paraater_list))`两边的括号必须存在，就像定义指向数组的指针一样。

例子：

```
int (*func(int i))[10];
```

理解：

- `func(int i)`表示调用func函数时需要一个int类型的实参。
- `(*func(int i))`意味着可以对函数调用的结果执行解引用操作。
- `(*func(int i))[10]`表示解引用func调用将得到一个大小为10的数组。
- `int (*func(int i))[10]`表示数组中的元素是int类型。

#### 使用尾置返回类型

**尾置返回类型（trailing return type）**在形参列表后面并以一个`->`符号开头。为了表示函数真真的返回类型跟在形参列表之后，我们在本该出现返回类型的地方放置一个auto：

```c++
auto func(int i) -> int(*)[10];
```

#### 使用decltype

如果知道函数返回的指针指向哪个数组就可以直接使用decltype关键字声明返回类型。但是decltype并不负责将数组类型转换成对应的指针。



